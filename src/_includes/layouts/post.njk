{% extends 'layouts/base.njk' %}

{% block head %}

	{% if coords %}
		<link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet" />
		<script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
		<script src="/assets/js/maps.js" defer></script>
	{% endif %}

{% endblock %}

{% block content %}

<main class="row padding-x-3 post">
	<article class="col-s-12">
		<header class="post-header margin-bottom-3">
			<h1 class="margin-x-0">{{ title }}</h1>
			<h2 class="margin-x-0">{{ excerpt }}</h2>
			<p>{% postTags tags, placeData %}</p>
		</header>

		{% if image %}
			<img 
			srcset="{% imgPath image, '1200', '', 'fit' %} 1200w, {% imgPath image, '2400', '', 'fit' %} 2400w, {% imgPath image, '2400', '', 'fit' %} 2x" 
			sizes="(max-width: 768px) 1200w" 
			class="post-featured-image" 
			/>
		{% endif %}

		<div class="row margin-x-3 post-content">
			<div class="col-s-12">
				{{ content | safe }}

				{% if gpx %}
					<a href="/gpx/{{ gpx }}" class="button margin-bottom-3" download>Download GPX File</a>
				{% endif %}
			</div>
		</div>
		
		{% if coords %}

			<div id="map" class="post-map-view" data-coords="{{ coords }}"></div>

		{% endif %}

		{% if images %}
	
			<div class="post-image-gallery margin-top-3">
				{% for img in images %}
					<img src="{% imgPath img.image, '600', '', 'fit' %}"  />
				{% endfor %}
			</div>
			
		{% endif %}

		<footer class="post-footer">
			<time>Originally published on {% timestamp date %}</time>

				{% set thisURL = page.url %}

			
				{% for item in tags %}
					{% if item !== 'post' %}
						<header class="post-footer-title margin-top-5 margin-bottom-2">See other places in <a href="/places/{{ placeData[item].slug }}/">{{ placeData[item].fullname }}</a></header>

						<div class="post-card-wrapper">
						{% for post in collections[item] %}

							{% if post.url !== thisURL %}
								{% set placeName = '' %}
								{% include "partials/post-card.njk" %}
							{% endif %}

						{% endfor %}
						</div>

					{% endif %}
				{% endfor %}
			
		</footer>

	</article>
</main>

{% endblock %}